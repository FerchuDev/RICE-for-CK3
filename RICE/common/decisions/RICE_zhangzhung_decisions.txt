
RICE_zhangzhung_adopt_new_tibetan_faith = {
	picture = { reference = "gfx/interface/illustrations/decisions/decision_ancient_himalayan_art.dds" }

	decision_group_type = major

	ai_check_interval = 32
	
	
	cooldown = { years = 30 }

	is_shown = {
		is_landed = yes
		faith = faith:old_bon
	}

	is_valid = {
		faith = faith:old_bon
	}
	
	is_valid_showing_failures_only = {
		RICE_is_available_adult_even_if_sick_trigger = yes		
	}
	
	widget = {
		gui = "decision_view_widget_RICE_zhangzhung_adopt_new_tibetan_faith"
		controller = decision_option_list_controller
		decision_to_second_step_button = "RICE_ADOPT_NEW_TIBETAN_FAITH_PICK_ACTION_TYPE"
		show_from_start = yes

		### Nangchos
		item = {
			value = choose_nangchos
			is_valid = {
				NOT = { faith = faith:lamaism }
			}
			current_description = choose_nangchos_desc
			localization = choose_nangchos_name
			icon = "gfx/interface/icons/faith/lamaism_buddhism.dds"
			ai_chance = {
				value = 15
				if = {
					limit = {
						any_sub_realm_county = {
							count >= 4
							faith = faith:lamaism
						}
					}
					add = 10
				}
				if = {
					limit = {
						any_sub_realm_county = {
							count >= 2
							faith = faith:lamaism
						}
					}
					add = 5
				}
				if = {
					limit = {
						any_character_to_title_neighboring_county = {
							exists = holder
							holder = {
								faith = faith:lamaism
							}
						}
					}
					add = 3
				}
			}
		}

		### New Bon
		item = {
			value = choose_new_bon
			is_valid = {
				NOT = { faith = faith:bon }
			}
			current_description = choose_new_bon_desc
			localization = choose_new_bon_name
			icon = "gfx/interface/icons/faith/bon.dds"
			ai_chance = {
				value = 10
				if = {
					limit = {
						any_sub_realm_county = {
							count >= 4
							faith = faith:bon
						}
					}
					add = 10
				}
				if = {
					limit = {
						any_sub_realm_county = {
							count >= 2
							faith = faith:bon
						}
					}
					add = 5
				}
				if = {
					limit = {
						any_character_to_title_neighboring_county = {
							exists = holder
							holder = {
								faith = faith:bon
							}
						}
					}
					add = 3
				}
			}
		}

		### Mahayana
		item = {
			value = choose_mahayana
			is_valid = {
				NOT = { faith = faith:mahayana }
			}
			current_description = choose_mahayana_desc
			localization = choose_mahayana_name
			icon = "gfx/interface/icons/faith/mahayana.dds"
			ai_chance = {
				value = 5
				if = {
					limit = {
						any_sub_realm_county = {
							count >= 4
							faith = faith:mahayana
						}
					}
					add = 10
				}
				if = {
					limit = {
						any_sub_realm_county = {
							count >= 2
							faith = faith:mahayana
						}
					}
					add = 5
				}
				if = {
					limit = {
						any_character_to_title_neighboring_county = {
							exists = holder
							holder = {
								faith = faith:mahayana
							}
						}
					}
					add = 3
				}
			}
		}

		### Vajrayana
		item = {
			value = choose_vajrayana
			is_valid = {
				NOT = { faith = faith:vajrayana }
			}
			current_description = choose_vajrayana_desc
			localization = choose_vajrayana_name
			icon = "gfx/interface/icons/faith/vajrayana.dds"
			ai_chance = {
				value = 5
				if = {
					limit = {
						any_sub_realm_county = {
							count >= 4
							faith = faith:vajrayana
						}
					}
					add = 10
				}
				if = {
					limit = {
						any_sub_realm_county = {
							count >= 2
							faith = faith:vajrayana
						}
					}
					add = 5
				}
				if = {
					limit = {
						any_character_to_title_neighboring_county = {
							exists = holder
							holder = {
								faith = faith:vajrayana
							}
						}
					}
					add = 3
				}
			}
		}

		### Manicheism
		item = {
			value = choose_manichean
			is_valid = {
				NOT = { faith = faith:manichean }
			}
			current_description = choose_manichean_desc
			localization = choose_manichean_name
			icon = "gfx/interface/icons/faith/manichean.dds"
			ai_chance = {
				value = 0
				if = {
					limit = {
						any_sub_realm_county = {
							count >= 4
							faith = faith:manichean
						}
					}
					add = 10
				}
				if = {
					limit = {
						any_sub_realm_county = {
							count >= 2
							faith = faith:manichean
						}
					}
					add = 5
				}
				if = {
					limit = {
						any_character_to_title_neighboring_county = {
							exists = holder
							holder = {
								faith = faith:manichean
							}
						}
					}
					add = 3
				}
			}
		}

		### Shaivism
		item = {
			value = choose_shaivism
			is_valid = {
				NOT = { faith = faith:shaivism }
			}
			current_description = choose_shaivism_desc
			localization = choose_shaivism_name
			icon = "gfx/interface/icons/faith/shaivism.dds"
			ai_chance = {
				value = 5
				if = {
					limit = {
						any_sub_realm_county = {
							count >= 4
							faith = faith:shaivism
						}
					}
					add = 10
				}
				if = {
					limit = {
						any_sub_realm_county = {
							count >= 2
							faith = faith:shaivism
						}
					}
					add = 5
				}
				if = {
					limit = {
						any_character_to_title_neighboring_county = {
							exists = holder
							holder = {
								faith = faith:shaivism
							}
						}
					}
					add = 3
				}
			}
		}

		### Nestorianism
		item = {
			value = choose_nestorian
			is_valid = {
				NOT = { faith = faith:nestorian }
			}
			current_description = choose_nestorian_desc
			localization = choose_nestorian_name
			icon = "gfx/interface/icons/faith/nestorian.dds"
			ai_chance = {
				value = 0
				if = {
					limit = {
						any_sub_realm_county = {
							count >= 4
							faith = faith:nestorian
						}
					}
					add = 10
				}
				if = {
					limit = {
						any_sub_realm_county = {
							count >= 2
							faith = faith:nestorian
						}
					}
					add = 5
				}
				if = {
					limit = {
						any_character_to_title_neighboring_county = {
							exists = holder
							holder = {
								faith = faith:nestorian
							}
						}
					}
					add = 3
				}
			}
		}

	}

	effect = {
		if = {
			limit = { scope:choose_nangchos = yes }
			RICE_convert_from_bon_lamaism_effect = yes
		}
		else_if = {
			limit = { scope:choose_new_bon = yes }
			RICE_convert_from_bon_new_bon_effect = yes
		}
		else_if = {
			limit = { scope:choose_mahayana = yes }
			RICE_convert_from_bon_mahayana_effect = yes
		}
		else_if = {
			limit = { scope:choose_vajrayana = yes }
			RICE_convert_from_bon_vajrayana_effect = yes
		}
		else_if = {
			limit = { scope:choose_manichean = yes }
			RICE_convert_from_bon_manichean_effect = yes
		}
		else_if = {
			limit = { scope:choose_shaivism = yes }
			RICE_convert_from_bon_shaivism_effect = yes
		}
		else_if = {
			limit = { scope:choose_nestorian = yes }
			RICE_convert_from_bon_nestorian_effect = yes
		}

		RICE_convert_from_bon_general_effect = yes

		trigger_event = zhangzhung.8888
		
	}
	
	cost = {
		piety = {
			value = major_piety_value
		}
	}
	
	ai_potential = {
		highest_held_title_tier >= tier_county
		is_landed = yes
		is_at_war = no
	}

	ai_will_do = {
		base = 20
		
		modifier = {
			add = {
				value = ai_zeal
				multiply = -0.5
			}
		}
		
		modifier = {
			add = -20
			has_trait = craven
		}
		
		modifier = {
			add = 20
			has_trait = ambitious
		}
		
	}
}


RICE_zhangzhung_rebuild_the_silver_castle = {
	picture = { reference = "gfx/interface/illustrations/decisions/decision_tibetan_village.dds" }
	decision_group_type = major
	ai_check_interval = 48

	#cooldown = { days = 10 } #1825
	
	desc = RICE_zhangzhung_rebuild_the_silver_castle_desc
	
	is_shown = {
		is_playable_character = yes
		culture = {
			has_cultural_tradition = tradition_RICE_zhangzhung_stonework
		}
	}
	
	is_valid = {
		is_landed = yes
		highest_held_title_tier >= tier_kingdom
		prestige_level >= 3
		piety_level >= 3
		culture = {
			has_cultural_tradition = tradition_RICE_zhangzhung_stonework
		}
	}
	
	is_valid_showing_failures_only = {
		is_available_adult = yes
	}

	effect = {
		custom_tooltip = RICE_zhangzhung_rebuild_the_silver_castle_effect_tooltip_1
		show_as_tooltip = {
			RICE_chios_build_homer_monument_effect = yes
		}
		if = {
			limit = {
				has_game_rule = RICE_historical_context_on
			}
			custom_tooltip = RICE_zhangzhung_rebuild_the_silver_castle_context_tooltip
		}
		trigger_event = {
			id = zhangzhung.8888
		}
	}

	cost = { 
		gold = { value = minor_gold_value } # Will depend 
	}	

	ai_potential = {
		short_term_gold > minor_gold_value
	}

	ai_will_do = {
		base = 25
	}
}

RICE_zhangzhung_supplicate_ancient_pillars = {
	picture = { reference = "gfx/interface/illustrations/decisions/decision_ancient_himalayan_art.dds" }
	ai_check_interval = 32
	
	cooldown = { days = 3650 } 

	desc = RICE_zhangzhung_supplicate_ancient_pillars_desc
	selection_tooltip = RICE_zhangzhung_supplicate_ancient_pillars_tooltip

	is_shown = {
		is_playable_character = yes
		OR = {
			any_held_county = {
				any_county_province = {
					geographical_region = RICE_upper_tibet
				}
			}
			culture = {
				has_cultural_tradition = tradition_RICE_zhangzhung_stonework
			}
		}
	}
	
	is_valid = {
		OR = {
			culture = {
				has_cultural_tradition = tradition_RICE_zhangzhung_stonework
			}
			custom_description = {
				text = RICE_upper_tibet_req
				any_held_county = {
					any_county_province = {
						geographical_region = RICE_upper_tibet
					}
				}
			}
		}
	}
	
	is_valid_showing_failures_only = {
		is_available_adult = yes
	}

	effect = {
		show_as_tooltip = {
			RICE_zhangzhung_pillars_general_effect = yes
		}
		custom_tooltip = RICE_zhangzhung_supplicate_ancient_pillars_effect_tooltip_1
		if = {
			limit = {
				has_game_rule = RICE_historical_context_on
			}
			custom_tooltip = RICE_zhangzhung_supplicate_ancient_pillars_context_tooltip
		}
		trigger_event = zhangzhung.0010 
	}

	cost = {
		gold = minor_gold_value # Will depend
		piety = medium_piety_gain
	}
	
	ai_potential = {
		short_term_gold > minor_gold_value
	}

	ai_will_do = {
		base = 25
		modifier = {
			add = -5
			has_trait = cynical
		}
		modifier = {
			add = 5
			has_trait = zealous
		}
		modifier = {
			add = -10
			has_trait = content
		}
		modifier = {
			add = 10
			has_trait = ambitious
		}
	}
}

RICE_zhangzhung_western_tibet_salt_decision = {
	picture = { reference = "gfx/interface/illustrations/decisions/decision_RICE_salt.dds" }
	ai_check_interval = 32
	
	cooldown = { days = 3650 } 

	desc = RICE_zhangzhung_western_tibet_salt_decision_desc
	selection_tooltip = RICE_zhangzhung_western_tibet_salt_decision_tooltip

	is_shown = {
		is_playable_character = yes
		any_held_county = {
			any_county_province = {
				geographical_region = RICE_western_northern_tibet
			}
		}
	}
	
	is_valid = {
		custom_description = {
			text = RICE_western_northern_tibet_req
			any_held_county = {
				any_county_province = {
					geographical_region = RICE_western_northern_tibet
				}
			}
		}
	}
	
	is_valid_showing_failures_only = {
		is_available_adult = yes
	}

	effect = {
		custom_tooltip = RICE_zhangzhung_western_tibet_salt_decision_effect_tooltip_1
		custom_tooltip = RICE_zhangzhung_western_tibet_salt_decision_effect_tooltip_2
		if = {
			limit = {
				culture = {
					has_cultural_tradition = tradition_RICE_master_whalers
				}
			}
			custom_tooltip = RICE_zhangzhung_western_tibet_salt_decision_effect_tooltip_3
		}
		if = {
			limit = {
				has_game_rule = RICE_historical_context_on
			}
			custom_tooltip = RICE_zhangzhung_western_tibet_salt_decision_context_tooltip
		}
		trigger_event = zhangzhung.0011
	}

	cost = {
		gold = RICE_himalayan_salt_decision_cost_value # Will depend
	}
	
	ai_potential = {
		short_term_gold > RICE_himalayan_salt_decision_cost_value
	}

	ai_will_do = {
		base = 25
		modifier = {
			add = -5
			has_trait = paranoid
		}
		modifier = {
			add = 5
			has_trait = greedy
		}
		modifier = {
			add = -10
			has_trait = content
		}
		modifier = {
			add = 10
			has_trait = ambitious
		}
	}
}

RICE_zhangzhung_eastern_tibet_salt_decision = {
	picture = { reference = "gfx/interface/illustrations/decisions/decision_RICE_salt.dds" }
	ai_check_interval = 32
	
	cooldown = { days = 3650 } 

	desc = RICE_zhangzhung_eastern_tibet_salt_decision_desc
	selection_tooltip = RICE_zhangzhung_eastern_tibet_salt_decision_tooltip

	is_shown = {
		is_playable_character = yes
		any_held_county = {
			any_county_province = {
				geographical_region = RICE_eastern_tibet_req
			}
		}
	}
	
	is_valid = {
		custom_description = {
			text = RICE_eastern_tibet_req_req
			any_held_county = {
				any_county_province = {
					geographical_region = RICE_eastern_tibet_req
				}
			}
		}
	}
	
	is_valid_showing_failures_only = {
		is_available_adult = yes
	}

	effect = {
		custom_tooltip = RICE_zhangzhung_eastern_tibet_salt_decision_effect_tooltip_1
		if = {
			limit = {
				has_game_rule = RICE_historical_context_on
			}
			custom_tooltip = RICE_zhangzhung_eastern_tibet_salt_decision_context_tooltip
		}
		trigger_event = zhangzhung.8888
	}

	cost = {
		gold = minor_gold_value # Will depend
	}
	
	ai_potential = {
		short_term_gold > minor_gold_value
	}

	ai_will_do = {
		base = 25
		modifier = {
			add = -5
			has_trait = paranoid
		}
		modifier = {
			add = 5
			has_trait = greedy
		}
		modifier = {
			add = -10
			has_trait = content
		}
		modifier = {
			add = 10
			has_trait = ambitious
		}
	}
}



#######################################
# 
# Adapted from Dharmachakra / Rajas of Asia (ROA)
#
# Select Personal diety decisions
#
#######################################

RICE_select_personal_deity_tibet_decision = {# Tibetan Gods and Goddesses	
	picture = {
		reference = "gfx/interface/illustrations/decisions/decision_ancient_himalayan_art.dds"
	}

	desc = select_personal_deity_tibet_decision_desc
	selection_tooltip = select_personal_yidam_decision_tooltip

	is_shown = {
		# RICE version will not appear if either Dharmachakra or Rajas of Asia is running
		is_dharmachakra_loaded = no
		roa_is_active = no
		OR = {
			religion = religion:bon_religion
			religion = religion:west_himayalan_religion
			AND = {
				religion = religion:buddhism_religion
				culture = { has_cultural_pillar = heritage_tibetan }
			}
		}
	}

	is_valid = {
		OR = {
			religion = religion:bon_religion
			religion = religion:west_himayalan_religion
			AND = {
				religion = religion:buddhism_religion
				culture = { has_cultural_pillar = heritage_tibetan }
			}
		}
	}

	is_valid_showing_failures_only = {
		is_available_adult = yes
	}

	minimum_cost = {
		piety = massive_piety_value
	}

	effect = {
		custom_tooltip = select_personal_yidam_decision_tt
		trigger_event = zhangzhung.0050
	}

	ai_check_interval = 96
	cooldown = { months = 36 }	

	ai_potential = {
		piety >= minor_piety_value
		NOR = {
			# Bon Tibetan Deities
			has_character_modifier = buddhist_deity_sipe_gyalmo # Sipe Gyalmo
			has_character_modifier = buddhist_deity_shenlha_okar # Shenlha Okar
			has_character_modifier = buddhist_deity_tonpa_shenrab # Tonpa Shenrab
			has_character_modifier = buddhist_deity_yeshe_walmo # Yeshe Walmo
			has_character_modifier = buddhist_deity_takla_mebar # Takla Mebar
			has_character_modifier = buddhist_deity_Zhambala # Zhambala
			has_character_modifier = buddhist_deity_sherab_chamma # Sherab Chamma
			# Buddhist Tibetan Deities
			has_character_modifier = buddhist_deity_palden_lhamo # Palden_Lhamo
			has_character_modifier = buddhist_deity_tara # Tara
			has_character_modifier = buddhist_deity_avalokitesvara  # Avalokiteśvara 
			has_character_modifier = buddhist_deity_yamantaka # Yamantaka
			has_character_modifier = buddhist_deity_hevajra # Hevajra
			has_character_modifier = buddhist_deity_vajrayogini # Vajrayogini
		}
	}

	ai_will_do = {
		base = 40
		modifier = {
			add = -10
			has_trait = cynical
		}
		modifier = {
			add = 10
			has_trait = zealous
		}
		modifier = {
			add = -10
			has_trait = lazy
		}
		modifier = {
			add = 10
			has_trait = diligent
		}
	}
}

# Burmese Gods and Goddesses
RICE_select_personal_nat_decision = {
	picture = {
		reference = "gfx/interface/illustrations/decisions/decision_indian_temple.dds"
	}

	desc = select_personal_nat_decision_desc
	selection_tooltip = select_personal_nat_decision_tooltip

	is_shown = {
		# RICE version will not appear if either Dharmachakra or Rajas of Asia is running
		is_dharmachakra_loaded = no
		roa_is_active = no
		OR = {
			religion = religion:burmic_religion
			AND = {
				religion = religion:buddhism_religion
				culture = { has_cultural_pillar = heritage_burman }
			}
		}
	}

	is_valid = {
		OR = {
			religion = religion:burmic_religion
			AND = {
				religion = religion:buddhism_religion
				culture = { has_cultural_pillar = heritage_burman }
			}
		}
	}

	is_valid_showing_failures_only = {
		is_available_adult = yes
	}

	minimum_cost = {
		piety = massive_piety_value
	}

	effect = {
		custom_tooltip = select_personal_nat_decision_tt
		trigger_event = zhangzhung.0051
	}

	ai_check_interval = 96
	cooldown = { months = 36 }	

	ai_potential = {
		piety >= minor_piety_value
		NOR = {
			# Ari Buddhist Nats
			has_character_modifier = nat_ari_thagyamin # Thagyamin
			has_character_modifier = nat_ari_mahagiri # Mahagiri
			has_character_modifier = nat_ari_hnamadawgyi # Hnamadawgyi
			has_character_modifier = nat_ari_ponmagyi # Ponmagyi
			has_character_modifier = nat_ari_sivali # Sīvali
			has_character_modifier = nat_ari_shwe_nabay # Shwe Nabay
			# Therevada Buddhist Nats
			has_character_modifier = nat_therevada_thurathadi # Thurathadi
			has_character_modifier = nat_therevada_lokanat  # Lokanat 
			has_character_modifier = nat_therevada_panhtwar # Panhtwar
			has_character_modifier = nat_therevada_shin_upagutta # Shin Upagutta
			has_character_modifier = nat_therevada_manimekhala # Manimekhala
		}
	}

	ai_will_do = {
		base = 40
		modifier = {
			add = -10
			has_trait = cynical
		}
		modifier = {
			add = 10
			has_trait = zealous
		}
		modifier = {
			add = -10
			has_trait = lazy
		}
		modifier = {
			add = 10
			has_trait = diligent
		}
	}
}

# Buddhist Gods and Goddesses
RICE_select_personal_deity_buddhist_decision = {
	picture = {
		reference = "gfx/interface/illustrations/decisions/decision_rice_buddhist_temple.dds"
	}
	decision_group_type = buddhist_medium

	desc = select_personal_deity_buddhist_decision_desc
	selection_tooltip = select_personal_deity_buddhist_decision_tooltip

	is_shown = {
		# RICE version will not appear if either Dharmachakra or Rajas of Asia is running
		is_dharmachakra_loaded = no
		roa_is_active = no
		religion = religion:buddhism_religion
		NOR = {
			faith = { has_doctrine = rice_theravada_canon_doctrine }
			faith = { has_doctrine = rice_pudgalavada_canon_doctrine }
		}
		NOR = {
			culture = { has_cultural_pillar = heritage_tibetan } 
			culture = { has_cultural_pillar = heritage_burman } 
		}
	}

	is_valid = {
		religion = religion:buddhism_religion
		NOR = {
			faith = { has_doctrine = rice_theravada_canon_doctrine }
			faith = { has_doctrine = rice_pudgalavada_canon_doctrine }
		}
		NOR = {
			culture = { has_cultural_pillar = heritage_tibetan } 
			culture = { has_cultural_pillar = heritage_burman } 
		}
	}

	is_valid_showing_failures_only = {
		is_available_adult = yes
	}

	minimum_cost = {
		piety = massive_piety_value
	}
	
	effect = {
		custom_tooltip = select_personal_meditional_deity_decision_tt
		trigger_event = zhangzhung.0052
	}

	ai_check_interval = 96
	cooldown = { months = 36 }	

	ai_potential = {
		piety >= minor_piety_value
		NOR = {
			# Bon Tibetan Deities
			has_character_modifier = buddhist_deity_sipe_gyalmo # Sipe Gyalmo
			has_character_modifier = buddhist_deity_shenlha_okar # Shenlha Okar
			has_character_modifier = buddhist_deity_tonpa_shenrab # Tonpa Shenrab
			has_character_modifier = buddhist_deity_yeshe_walmo # Yeshe Walmo
			has_character_modifier = buddhist_deity_takla_mebar # Takla Mebar
			has_character_modifier = buddhist_deity_Zhambala # Zhambala
			has_character_modifier = buddhist_deity_sherab_chamma # Sherab Chamma
			# Buddhist Tibetan Deities
			has_character_modifier = buddhist_deity_palden_lhamo # Palden_Lhamo
			has_character_modifier = buddhist_deity_tara # Tara
			has_character_modifier = buddhist_deity_avalokitesvara  # Avalokiteśvara 
			has_character_modifier = buddhist_deity_yamantaka # Yamantaka
			has_character_modifier = buddhist_deity_hevajra # Hevajra
			has_character_modifier = buddhist_deity_vajrayogini # Vajrayogini
		}
	}

	ai_will_do = {
		base = 40
		modifier = {
			add = -10
			has_trait = cynical
		}
		modifier = {
			add = 10
			has_trait = zealous
		}
		modifier = {
			add = -10
			has_trait = lazy
		}
		modifier = {
			add = 10
			has_trait = diligent
		}
	}
}
